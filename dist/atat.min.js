!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.atat=n():t.atat=n()}(window,function(){return(r={},i.m=e=[function(t,n,e){"use strict";function u(){}e.r(n);var d="outside",h="inside",r={'"':"&#34;","&":"&#38;","'":"&#39;","/":"&#47;","<":"&#60;",">":"&#62;"},i=/&(?!#?\w+;)|<|>|"|'|\//g,o={encode:function(t){void 0===t&&(t="");return t.toString().replace(i,function(t){return r[t]||t})},join:function(t,n){void 0===t&&(t=[]);void 0===n&&(n="");return Array.prototype.join.call(t,n)},json:function(t){return JSON.stringify(t)},lower:function(t){void 0===t&&(t="");return t.toString().toLowerCase()},upper:function(t){void 0===t&&(t="");return t.toString().toUpperCase()}};function l(t,n){for(var e in void 0===n&&(n={}),t)!n.hasOwnProperty(e)&&t.hasOwnProperty(e)&&("object"==typeof t[e]?n[e]=l(t[e]):n[e]=t[e]);return n}function a(t,n){if("[object Array]"===Object.prototype.toString.call(t))for(var e=0,r=t.length;e<r;e+=1)n(t[e],e,t);else for(var i in t)t.hasOwnProperty(i)&&n(t[i],i,t)}function f(t,n,r){for(var i=0,o=!1,u=[],l=t.length,e=0;e<l;e+=1)n(t[e],e,t,a(e));function a(e){return function(t,n){if(!o){if(t)return o=!0,void r(t);u[e]=n,(i+=1)===l&&(o=!0,r(null,u))}}}}function s(t){return function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];if(0===n.length)return String.prototype.trim.call(t);for(var r=t;0<=n.indexOf(t.charAt(0));)r=t.substring(1);for(;0<=n.indexOf(t.charAt(t.length-1));)r=t.substring(0,t.length-1);return r}(t).replace(/^"(.*)"$/g,"$1").replace(/^'(.*)'$/g,"$1")}var c={"(@!\\()([^]*?)(\\)@)":function(t,n,e){try{""===t.value.trim()&&e(),e(null,"this.output += ("+t.value.trim()+");")}catch(t){e(t)}},"(@\\()([^]*?)(\\)@)":function(t,n,e){try{""===t.value.trim()&&e(),e(null,"this.output += this.helpers.encode("+t.value.trim()+");")}catch(t){e(t)}},"(@layout\\()([^]*?)(\\)@)":function(t,e,r){try{if(e.layout)return r();O.loadAndParse(s(t.value),e.options,function(t,n){if(t)return r(t);(e.layout=n).context.parent=e,r()})}catch(t){r(t)}},"(@partial\\()([^]*?)(\\)@)":function(t,r,i){try{var n=t.value.trim();if(""===n)return i(new Error("Partial parsing error"));var o=n.split(/\s*,\s*/g),e=s(o.shift());O.loadAndParse(e,r.options,function(t,n){if(t)return i(t);r.partials.push(n);var e="this.output += this.partials["+((n.context.parent=r).partials.length-1)+"]("+o+");";i(null,e)})}catch(t){i(t)}},"(@section\\()([^]*?)(\\)@)":function(t,n,e){try{var r="this.output += (function(){var s = this.section('"+s(t.value)+"'); return s?s("+n.arguments+'):"";}).call(this);';e(null,r)}catch(t){e(t)}}};function p(t,n,e){for(var r,i,o,u,l=n.global,a=n.sticky,s=[],f=0,c=0,p=0,v=0;;){if(o=g(t,n,p),u=g(t,e,p),o&&u&&(o.index<=u.index?u=null:o=null),o||u)p=(c=(o||u).index)+(o||u)[0].length;else if(!f)break;if(a&&!f&&v<c)break;if(o)f||(r=c,i=p),f+=1;else{if(!u||!f)throw new Error("Unbalanced delimiter found in string");if(!(f-=1)&&(v<r&&s.push({name:d,value:t.slice(v,r),start:v,end:r}),s.push({name:h,value:t.slice(i,c),start:i,end:c,left:{value:t.slice(r,i),start:r,end:i},right:{value:t.slice(c,p),start:c,end:p}}),v=p,!l))break}c===p&&(p+=1)}return l&&t.length>v&&s.push({end:t.length,name:d,start:v,value:t.slice(v)}),s}function v(t,n,e){void 0===e&&(e=0),n.lastIndex=e;var r=n.test(t);return n.global&&(n.lastIndex=r?n.lastIndex:0),r}function g(t,n,e){void 0===e&&(e=0),n.lastIndex=e;var r=n.exec(t);return n.global&&(n.lastIndex=r?n.lastIndex:0),r}function m(t){for(var n=0;n<t.length;n+=1)void 0===t[n]&&(t.splice(n,1),n-=1)}var y=(b.prototype.compile=function(t,a,e){var s=this;try{if(0===t.length)return void e(null,"");f(p(t,a.tags.open,a.tags.close),function(t,n,e,r){try{if(t.name===d)return""===t.value.trim()?void r(null,""):void s.compileInline(t.value,a,r);if(t.name===h){var i=t.left,o=t,u=t.right,l=a.compiler(i.value);return l?void l.call(s,o,a,r):void s.compileInline(i.value+o.value+u.value,a,r)}}catch(t){r(t)}},function(t,n){if(t)return e(t);e(null,n.join(""))})}catch(t){e(t)}},b.prototype.compileInline=function(t,a,e){var s=this;try{if(0===t.length)return void e(null,"");f(function(t,n){for(var e,r,i=n.global,o=n.sticky,u=[],l=0,a=0;;){var s=g(t,n,l);if(null===s)break;if(a=s.index,o&&l<a)break;if(m(s),r=l+(e=a+s[1].length)+s[2].length,l<a&&u.push({name:d,value:t.slice(l,a),start:l,end:a}),u.push({name:h,value:s[2],start:e,end:r,left:{value:s[1],start:a,end:e},right:{value:s[3],start:r,end:r+s[3].length}}),l=a+s[0].length,!i)break}return i&&t.length>l&&u.push({name:d,value:t.slice(l),start:l,end:t.length}),u}(t,a.inline),function(t,n,e,r){try{if(t.name===d)return a.parts.push(t.value),void r(null,"this.output += this.parts["+(a.parts.length-1)+"];");if(t.name===h){var i=t.left,o=t,u=t.right;if(""===o.value.trim())return void r(null,"");var l=a.compiler(i.value+o.value+u.value);return l?void l.call(s,o,a,r):void function(t,n,e){try{var r=t.left.value.substring(1,t.left.value.length-1);if("function"!=typeof n.helpers[r])throw new Error("Helper "+r+" isn't declarated");e(null,"this.output += this.helpers."+r+"("+t.value.trim()+");")}catch(t){e(t)}}.call(s,o,a,r)}}catch(t){r(t)}},function(t,n){if(t)return e(t);e(null,n.join(""))})}catch(t){e(t)}},b);function b(){}var x={it:"it",$:"$",helpers:{},fileResolver:new function(){this.loadFile=function(t,n){try{e(!function(){var t=new Error("Cannot find module 'fs'");throw t.code="MODULE_NOT_FOUND",t}()).readFile(t,"utf-8",n)}catch(t){n(t)}}}},w={"@\\{":function(t,n,e){e(null,t.value.trim())},"@for\\s*\\(":function(t,n,e){var r=p("for("+t.value+"}",/\{/g,/\}/g),i="";i+=r[0].value,i+="{",this.compile(r[1].value,n,function(t,n){if(t)return e(t);i+=n,e(null,i+="}")})},"@function\\s+[$A-Za-z0-9]*\\s*\\(":function(t,n,e){var r=t.left.value.trim().substring(1);e(null,""+r+t.value.trim()+"}")},"@if\\s*\\(":function(t,i,e){var o=this;f(p("if("+t.value+"}",/\{/g,/\}/g),function(t,n,e,r){if(t.name===d)return r(null,t.value);o.compile(t.value,i,r)},function(t,n){if(t)return e(t);e(null,n.join(""))})},"@section\\s+[$A-Za-z0-9]*\\s*\\{":function(t,e,r){var n=t.value.trim(),i=g(t.left.value.trim(),/^@section\s+([A-Za-z0-9]+)\s*\{/g);if(!i||2<i.length)return r(new Error("Section parsing error"));var o=i[1].trim();if(e.sections[o])return r(new Error("Section already exists"));O.parse(n,e.options,function(t,n){if(t)return r(t);(n.context.parent=e).sections[o]=n,r(null)})},"@while\\s*\\(":function(t,n,e){var r=p("while("+t.value+"}",/\{/g,/\}/g),i="";i+=r[0].value,i+="{",this.compile(r[1].value,n,function(t,n){if(t)return e(t);i+=n,e(null,i+="}")})}};var P=(j.prototype.section=function(t){return t?this.sections[t]||this.parent&&this.parent.section(t):null},j.prototype.compiler=function(t){void 0===t&&(t="");for(var n=0,e=this.tags.compilers.length;n<e;n+=1){var r=this.tags.compilers[n];if(v(t,r.regexp))return r.compiler}return null},j);function j(t){var e=this;this.options=l(x,t),this.helpers=l(o,t.helpers),this.model=null,this.output="",this.parts=[],this.parent=null,this.arguments=[this.options.it,this.options.$,"body"].join(","),this.tags=function(t){var e=[];a(t,function(t,n){-1===e.indexOf(n)&&e.push(n)});var r=[];return a(t,function(t,n){r.push({compiler:t,regexp:new RegExp(n,"g")})}),{compilers:r,close:/}@/g,open:new RegExp(e.join("|"),"g")}}(w),this.inline=function(t){var e=[];return a(t,function(t,n){e.push(n)}),e.push("(@[A-Za-z0-9$]+\\()([^]*?)(\\)@)"),new RegExp(e.join("|"),"g")}(c),a(c,function(t,n){e.tags.compilers.push({compiler:t,regexp:new RegExp(n,"g")})}),this.layout=null,this.partials=[],this.sections={}}e.d(n,"atat",function(){return O});var O={config:function(t){var n=l(x,t);for(var e in n)x.hasOwnProperty(e)&&(x[e]=n[e])},parse:function(t,n,e){void 0===n&&(n={}),void 0===e&&(e=u);var i=n,r=e;if("function"==typeof i&&(r=i,i={}),r===u&&"undefined"!=typeof Promise)return new Promise(function(e,r){O.parse(t,i,function(t,n){t?r(t):e(n)})});var o=new P(i);(new y).compile(t,o,function(t,n){if(t)return r(t);var e=new Function(o.arguments,n+";return this.output;");o.template=function(t){try{o.output="",o.model=t||o.model;var n=e.call(o,o.model,o.helpers,o.body);return o.layout&&(o.layout.context.body=n,n=o.layout(o.model)),n}catch(t){return t.toString()}},o.template.context=o,r(null,o.template)})},loadAndParse:function(t,n,e){void 0===n&&(n={}),void 0===e&&(e=u);var i=n,r=e;if("function"==typeof i&&(r=i,i={}),r===u&&"undefined"!=typeof Promise)return new Promise(function(e,r){O.loadAndParse(t,i,function(t,n){t?r(t):e(n)})});(i.fileResolver||x.fileResolver).loadFile(t,function(t,n){t?r(t):O.parse(n,i,r)})},render:function(t,i,n,e){void 0===i&&(i={}),void 0===n&&(n={}),void 0===e&&(e=u);var o=n,r=e;if("function"==typeof o&&(r=o,o={}),r===u&&"undefined"!=typeof Promise)return new Promise(function(e,r){O.render(t,i,o,function(t,n){t?r(t):e(n)})});O.parse(t,o,function(t,n){t?r(t):r(null,n(i))})},loadAndRender:function(t,i,n,e){void 0===n&&(n={}),void 0===e&&(e=u);var o=n,r=e;if("function"==typeof o&&(r=o,o={}),r===u&&"undefined"!=typeof Promise)return new Promise(function(e,r){O.loadAndRender(t,i,o,function(t,n){t?r(t):e(n)})});O.loadAndParse(t,o,function(t,n){t?r(t):r(null,n(i))})},__express:function(t,e,r){O.loadAndParse(t,function(t,n){t?r(t.toString()):r(null,n(e))})}}}],i.c=r,i.d=function(t,n,e){i.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(n,t){if(1&t&&(n=i(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var r in n)i.d(e,r,function(t){return n[t]}.bind(null,r));return e},i.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(n,"a",n),n},i.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},i.p="",i(i.s=0)).atat;function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}var e,r});
//# sourceMappingURL=atat.min.js.map