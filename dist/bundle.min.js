!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.atat=e():t.atat=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.noop=function(){},e.VALUE_NAME_OUTSIDE="outside",e.VALUE_NAME_INSIDE="inside",e.HTML_RULES={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},e.CLEAR_TAGS=/[-[\](){}*+?.,\\^$|#\s]/g,e.MATCH_HTML=/&(?!#?\w+;)|<|>|"|'|\//g},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);function i(t,e){if("[object Array]"===Object.prototype.toString.call(t))for(var n=0,r=(t=t).length;n<r;n++)e(t[n],n,t);else for(var i in t=t)t.hasOwnProperty(i)&&e(t[i],i,t)}function o(t){return void 0===t&&(t=""),t.toString().replace(r.MATCH_HTML,function(t){return r.HTML_RULES[t]||t})}function u(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(0==e.length)return String.prototype.trim.call(t);for(;e.indexOf(t.charAt(0))>=0;)t=t.substring(1);for(;e.indexOf(t.charAt(t.length-1))>=0;)t=t.substring(0,t.length-1);return t}function l(t){return JSON.stringify(t)}function a(t,e){return void 0===t&&(t=[]),void 0===e&&(e=""),Array.prototype.join.call(t,e)}function s(t){return void 0===t&&(t=""),t.toString().toUpperCase()}function c(t){return void 0===t&&(t=""),t.toString().toLowerCase()}e.helpers={encode:o,json:l,join:a,upper:s,lower:c},e.merge=function t(e,n){for(var r in void 0===n&&(n={}),e)!n.hasOwnProperty(r)&&e.hasOwnProperty(r)&&("object"==typeof e[r]?n[r]=t(e[r]):n[r]=e[r]);return n},e.get_tags=function(t){var e=[];return i(t,function(t,n){-1===e.indexOf(n)&&e.push(n)}),{open:new RegExp(e.join("|"),"g"),close:/}@/g,compilers:[]}},e.get_tags_inline=function(t){var e=[];return i(t,function(t,n){e.push(n)}),e.push("(@[A-Za-z0-9$]+\\()([^]*?)(\\)@)"),new RegExp(e.join("|"),"g")},e.loop=i,e.loop_async=function(t,e,n){for(var r=0,i=!1,o=[],u=t.length,l=0;l<u;l++)e(t[l],l,t,a(l));function a(t){return function(e,l){if(!i){if(e)return i=!0,void n(e);o[t]=l,++r==u&&(i=!0,n(null,o))}}}},e.encode_html=o,e.trim_string=u,e.escape_quotes=function(t){return u(t).replace(/^"(.*)"$/g,"$1").replace(/^'(.*)'$/g,"$1")},e.json_stringify=l,e.join_helper=a,e.uppercase_helper=s,e.lowercase_helper=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);function i(t,e,n){void 0===n&&(n=0),e.lastIndex=n;var r=e.exec(t);return e.global&&(e.lastIndex=r?e.lastIndex:0),r}function o(t){for(var e=0;e<t.length;e++)void 0===t[e]&&(t.splice(e,1),e--)}e.match_recursive=function(t,e,n){for(var o,u,l,a,s=e.global,c=e.sticky,p=[],f=0,_=0,v=0,h=0;;){if(l=i(t,e,v),a=i(t,n,v),l&&a&&(l.index<=a.index?a=null:l=null),l||a)v=(_=(l||a).index)+(l||a)[0].length;else if(!f)break;if(c&&!f&&_>h)break;if(l)f||(o=_,u=v),++f;else{if(!a||!f)throw new Error("Unbalanced delimiter found in string");if(!--f&&(o>h&&p.push({name:r.VALUE_NAME_OUTSIDE,value:t.slice(h,o),start:h,end:o}),p.push({name:r.VALUE_NAME_INSIDE,value:t.slice(u,_),start:u,end:_,left:{value:t.slice(o,u),start:o,end:u},right:{value:t.slice(_,v),start:_,end:v}}),h=v,!s))break}_===v&&++v}return s&&t.length>h&&p.push({name:r.VALUE_NAME_OUTSIDE,value:t.slice(h),start:h,end:t.length}),p},e.regexp_test=function(t,e,n){void 0===n&&(n=0),e.lastIndex=n;var r=e.test(t);return e.global&&(e.lastIndex=r?e.lastIndex:0),r},e.regexp_exec=i,e.clean_array=o,e.match_inline=function(t,e){for(var n,u,l=e.global,a=e.sticky,s=[],c=0,p=0;;){var f=i(t,e,c);if(null==f)break;if(p=f.index,a&&p>c)break;if(o(f),u=c+(n=p+f[1].length)+f[2].length,p>c&&s.push({name:r.VALUE_NAME_OUTSIDE,value:t.slice(c,p),start:c,end:p}),s.push({name:r.VALUE_NAME_INSIDE,value:f[2],start:n,end:u,left:{value:f[1],start:p,end:n},right:{value:f[3],start:u,end:u+f[3].length}}),c=p+f[0].length,!l)break}return l&&t.length>c&&s.push({name:r.VALUE_NAME_OUTSIDE,value:t.slice(c),start:c,end:t.length}),s}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9),i=n(6),o=n(0),u=n(5);e.atat={compileByPath:function(t,n,r){void 0===n&&(n={}),void 0===r&&(r=o.noop),"function"==typeof n&&(r=n,n={}),u.load_file(t,function(t,i){if(t)return r(t);e.atat.compile(i,n,r)})},compile:function(t,e,n){void 0===e&&(e={}),void 0===n&&(n=o.noop),"function"==typeof e&&(n=e,e={});var u=new r.AtatContext(e);(new i.AtatCompiler).compile(t,u,function(t,e){if(t)return n(t);var r=new Function(u.arguments,e+";return this.output;");u.template=function(t){try{u.output="",u.model=t||u.model;var e=r.call(u,u.model,u.helpers,u.body);return u.__layout&&(u.__layout.__context.body=e,e=u.__layout(u.model)),e}catch(t){return t.toString()}},u.template.__context=u,n(null,u.template)})},__express:function(t,n,r){e.atat.compileByPath(t,function(t,e){return t?r(t.toString()):r(null,e(n))})}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),i=n(3);e.inline_tags={"(@section\\()([^]*?)(\\)@)":function(t,e,n){try{var i=r.escape_quotes(t.value),o="this.output += (function(){var s = this.section('"+i+"'); return s?s("+e.arguments+'):"";}).call(this);';n(null,o)}catch(t){n(t)}},"(@layout\\()([^]*?)(\\)@)":function(t,e,n){try{if(e.__layout)return n();i.atat.compileByPath(r.escape_quotes(t.value),e.options,function(t,r){if(t)return n(t);e.__layout=r,r.__context.parent=e,n()})}catch(t){n(t)}},"(@partial\\()([^]*?)(\\)@)":function(t,e,n){try{var o=t.value.trim();if(""==o)return n(new Error("Partial parsing error"));var u=o.split(/\s*,\s*/g),l=r.escape_quotes(u.shift());i.atat.compileByPath(l,e.options,function(t,r){if(t)return n(t);e.__partials.push(r),r.__context.parent=e;var i="this.output += this.__partials["+(e.__partials.length-1)+"]("+u+");";n(null,i)})}catch(t){n(t)}},"(@\\()([^]*?)(\\)@)":function(t,e,n){try{var r=t.value.trim();""===r&&n(),n(null,"this.output += this.helpers.encode("+t.value.trim()+");")}catch(t){n(t)}},"(@!\\()([^]*?)(\\)@)":function(t,e,n){try{var r=t.value.trim();""===r&&n(),n(null,"this.output += ("+t.value.trim()+");")}catch(t){n(t)}}},e.output_call_helper=function(t,e,n){try{var r=t.left.value.substring(1,t.left.value.length-1);if("function"!=typeof e.helpers[r])throw'Helper "'+r+"\" didn't declarated";n(null,"this.output += this.helpers."+r+"("+t.value.trim()+");")}catch(t){n(t)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.load_file=function(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.onreadystatechange=function(){4===this.readyState&&(this.status>=200&&this.status<400?e(null,this.responseText):e(new Error('Not able to load template "'+t+'"')))},n.send(),n=null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(1),o=n(2),u=n(4),l=function(){function t(){}return t.prototype.compile=function(t,e,n){var u=this;try{var l=o.match_recursive(t,e.tags.open,e.tags.close);i.loop_async(l,function(t,n,i,o){try{if(t.name==r.VALUE_NAME_OUTSIDE)return""==t.value.trim()?void o(null,""):void u.compile_inline(t.value,e,o);if(t.name==r.VALUE_NAME_INSIDE){var l=t.left,a=t,s=t.right,c=e.compiler(l.value);return c?void c.call(u,a,e,o):void u.compile_inline(l.value+a.value+s.value,e,o)}}catch(t){o(t)}},function(t,e){if(t)return n(t);n(null,e.join(""))})}catch(t){n(t)}},t.prototype.compile_inline=function(t,e,n){var l=this;try{var a=o.match_inline(t,e.inline);i.loop_async(a,function(t,n,i,o){try{if(t.name==r.VALUE_NAME_OUTSIDE)return e.parts.push(t.value),void o(null,"this.output += this.parts["+(e.parts.length-1)+"];");if(t.name==r.VALUE_NAME_INSIDE){var a=t.left,s=t,c=t.right;if(""==s.value.trim())return void o(null,"");var p=e.compiler(a.value+s.value+c.value);return p?void p.call(l,s,e,o):void u.output_call_helper.call(l,s,e,o)}}catch(t){o(t)}},function(t,e){if(t)return n(t);n(null,e.join(""))})}catch(t){n(t)}},t}();e.AtatCompiler=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),i=n(2),o=n(1),u=n(3);e.tags={"@\\{":function(t,e,n){n(null,t.value.trim())},"@if\\s*\\(":function(t,e,n){var u=this,l="if("+t.value+"}",a=i.match_recursive(l,/\{/g,/\}/g);o.loop_async(a,function(t,n,i,o){if(t.name==r.VALUE_NAME_OUTSIDE)return o(null,t.value);u.compile(t.value,e,o)},function(t,e){if(t)return n(t);n(null,e.join(""))})},"@while\\s*\\(":function(t,e,n){var r="while("+t.value+"}",o=i.match_recursive(r,/\{/g,/\}/g),u="";u+=o[0].value,u+="{",this.compile(o[1].value,e,function(t,e){if(t)return n(t);u+=e,n(null,u+="}")})},"@for\\s*\\(":function(t,e,n){var r="for("+t.value+"}",o=i.match_recursive(r,/\{/g,/\}/g),u="";u+=o[0].value,u+="{",this.compile(o[1].value,e,function(t,e){if(t)return n(t);u+=e,n(null,u+="}")})},"@function\\s+[$A-Za-z0-9]*\\s*\\(":function(t,e,n){var r=t.left.value.trim().substring(1);n(null,r+t.value.trim()+"}")},"@section\\s+[$A-Za-z0-9]*\\s*\\{":function(t,e,n){var r=t.value.trim(),o=t.left.value.trim(),l=i.regexp_exec(o,/^@section\s+([A-Za-z0-9]+)\s*\{/g);if(!l||l.length>2)return n(new Error("Section parsing error"));var a=l[1].trim();if(e.__sections[a])return n(new Error("Section already exists"));u.atat.compile(r,e.options,function(t,r){if(t)return n(t);r.__context.parent=e,e.__sections[a]=r,n(null)})}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AtatDefaultOpions={modelname:"it",helpersname:"$",basePath:"",helpers:{}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(8),i=n(1),o=n(2),u=n(4),l=n(7),a=function(){function t(t){var e=this;this.options=i.merge(r.AtatDefaultOpions,t),this.output="",this.model=null,this.helpers=i.merge(i.helpers,t.helpers),this.parts=[],this.arguments=[this.options.modelname,this.options.helpersname,"body"].join(","),this.tags=i.get_tags(l.tags),this.inline=i.get_tags_inline(u.inline_tags),i.loop(l.tags,function(t,n){e.tags.compilers.push({compiler:t,regexp:new RegExp(n,"g")})}),i.loop(u.inline_tags,function(t,n){e.tags.compilers.push({compiler:t,regexp:new RegExp(n,"g")})}),this.__layout=null,this.__partials=[],this.__sections={},this.parent=null}return t.prototype.section=function(t){return t?this.__sections[t]||this.parent&&this.parent.section(t):null},t.prototype.compiler=function(t){void 0===t&&(t="");for(var e=0,n=this.tags.compilers.length;e<n;e++){var r=this.tags.compilers[e];if(o.regexp_test(t,r.regexp))return r.compiler}return null},t}();e.AtatContext=a}]).atat});
//# sourceMappingURL=bundle.min.js.map